---
title: "ERGM_team"
author: "Timo Timmermans"
date: "2024-11-13"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load data}
library(igraph)
```


```{r load data}
valid_edges <- read.csv("Valid_edges.csv")
data_combined <- read.csv("vertice_data.csv")
state_dependency_matrix <- read.csv("state_dependency_matrix.csv")
```



```{r pressure, echo=FALSE}
rivalry_edges <- subset(valid_edges, type == "rivalry")
g <- igraph::graph_from_data_frame(d = rivalry_edges, vertices = data_combined, directed = FALSE)
g <- snafun::to_network(g)

# Identify and remove isolates (nodes with degree zero)
isolates <- V(g)[degree(g) == 0]  # Find nodes with no connections
g <- delete_vertices(g, isolates)  # Remove isolates

# Filter only alliance relationships
alliance_edges <- subset(valid_edges, type == "alliance")
g_alliances <- graph_from_data_frame(d = alliance_edges, vertices = data_combined, directed = FALSE)
g_alliances <- snafun::to_network(g_alliances)

```



```{r}
m0 <- ergm::ergm(g ~ edges)
summary(m0)

```
```{r}
g_alliances_matrix <- as.matrix(g_alliances)
(dim(g_alliances_matrix))  # Ensure this matches the dimension of g
(any(is.na(g_alliances_matrix)))


g_rivalry_matrix <- as.matrix(g)
(dim(g_rivalry_matrix))  # Ensure this matches the dimension of g
(any(is.na(g_rivalry_matrix)))

state_dependency_matrix <- as.matrix(state_dependency_matrix)
```




```{r}
m1 <-ergm::ergm((g ~ edges + gwesp(0.5, fixed = TRUE) + edgecov(g_alliances_matrix)),
                  control = ergm::control.ergm(MCMC.burnin = 5000,
                                               MCMC.samplesize = 10000,
                                               seed = 123456,
                                               init = c(-5, 0.1, 0.1),
                                               MCMLE.maxit = 20))
summary(m1)

```






